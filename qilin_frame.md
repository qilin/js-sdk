### Авторизация

```
const qilinFrameHelper = qilinGameFrame(
  qilinProductUUID: string,
  apiURL: string,
  onAuth?: (meta: any, url: string) => Promise
);
```

Создаем объект-хэлпер внутри тега script в iframe с игрой.
Где `qilinProductUUID` - уникальный `uid` игры в базе `qilin`,
`apiURL` - адрес сервера`qilin`,
а `onAuth` - функция авторизации, опциональный параметр. Если передается, то используется для авторизации. Если нет, то для авторизации используется функция по умолчанию, которая обращается к бэкенду `qilin` и возвращает промисс, который резолвится в объект вида:

```
interface response {
  code: number;
  meta: any;
  msg?: string;
}
```
Где `code` код ответа от сервера, `meta` - метаинформация, которая будет передана в игру после инициализации, а `msg` - опциональный параметр - какое-то сообщение или реджектится в ошибку.

Для запуска авторизации вызываем метод `init` у объекта-хэлпера.

```
qilinFrameHelper.init()
  .then((meta: any) => {
    ... Код игры
  })
  .catch(error => {
    ... Обработка ошибки авторизации
  })
```

### Биллинг

Для вызова платежной формы необходимо вызвать метод `showPaymentForm` у объекта-хэлпера

```
qilinFrameHelper.showPaymentForm(itemId, userId);
```

После этого, данные вместе с `qilinProductUUID` будут с помощью `postMessage` отправлены в окно, открывшее iframe, и далее сервер-то-сервер обработка биллинга.

После того, как платежная форма закроется, в окно игры также с помощью `postMessage` отправляется событие со статусом операции. `true` - успешно,`false` - отмена или ошибка при проведении операции.

После получения события, объект-хэлпер вызовет колбеки, которые будут повешены на закрытие платежной формы.

```
const callback = (status: boolean) => {
  ...Запрос у сервера обновленного состояния
};

qilinFrameHelper.addCallback(PAYMENT_FORM_CLOSED, callback);
```

Где `PAYMENT_FORM_CLOSED` константа, доступная из SDK.