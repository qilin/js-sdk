### Авторизация

```
qilinGame.init({
  qilinProductUUID: string,
  apiURL: string,
  meta?: any,
  onAuth?: (meta: any, url: string) => Promise
}).then((meta: any) => {
    ... Код игры
  })
  .catch(error => {
    ... Обработка ошибки авторизации
  });
```

Инициализируем объект-хэлпера внутри тега script в iframe с игрой.
Где `qilinProductUUID` - уникальный `uid` игры в базе `qilin`,
`apiURL` - адрес сервера`qilin`,
`meta` - какие - то метаданные,
а `onAuth` - функция авторизации, опциональный параметр. Если передается, то используется для авторизации. Если нет, то для авторизации используется функция по умолчанию, которая обращается к бэкенду `qilin` и возвращает промисс, который резолвится в объект вида:

```
interface response {
  code: number;
  meta: any;
  msg?: string;
}
```
Где `code` код ответа от сервера, `meta` - метаинформация, которая будет передана в игру после инициализации, а `msg` - опциональный параметр - какое-то сообщение или реджектится в ошибку.

### Биллинг

Для вызова платежной формы необходимо вызвать метод `showPaymentForm` у объекта-хэлпера

```
qilinGame.showPaymentForm(itemId, userId);
```

После этого, данные вместе с `qilinProductUUID` будут с помощью `postMessage` отправлены в окно, открывшее iframe, и далее сервер-то-сервер обработка биллинга.

После того, как платежная форма закроется, в окно игры также с помощью `postMessage` отправляется событие со статусом операции. `true` - успешно,`false` - отмена или ошибка при проведении операции.

После получения события, объект-хэлпер вызовет колбеки, которые будут повешены на закрытие платежной формы.

```
const callback = ({ status }) => {
  ...Запрос у сервера обновленного состояния
};

qilinGame.addCallback(PAYMENT_FORM_CLOSED, callback);
```

Где `PAYMENT_FORM_CLOSED` константа, доступная из SDK.

### Полноэкранный режим

Если игра умеет разворачиваться в полноэкранном режиме то с помощью хэлпера об этом можно сообщить родительской странице:

```
qilinGame.enableFullscreenMode();
```

После этого можно будет подписаться на событие `FULLSCREEN_MODE_CHANGED`, Где `FULLSCREEN_MODE_CHANGED` константа, доступная из SDK.

```
const callback = ({ fullscreen }) => {
  ...
};

qilinGame.addCallback(FULLSCREEN_MODE_CHANGED, callback);
```
